{"ast":null,"code":"import{useState,useEffect}from\"react\";import{Navigate,useLocation,useNavigate}from\"react-router-dom\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=process.env.REACT_APP_BACKEND_URL;export default function ProtectedRoute(_ref){var _useLocation$state,_useLocation$state2;let{children}=_ref;const[isAuthenticated,setIsAuthenticated]=useState((_useLocation$state=useLocation().state)!==null&&_useLocation$state!==void 0&&_useLocation$state.user?true:null);const[user,setUser]=useState(((_useLocation$state2=useLocation().state)===null||_useLocation$state2===void 0?void 0:_useLocation$state2.user)||null);const location=useLocation();const navigate=useNavigate();useEffect(()=>{var _location$state;if((_location$state=location.state)!==null&&_location$state!==void 0&&_location$state.user)return;const checkAuth=async()=>{try{const response=await axios.get(\"\".concat(BACKEND_URL,\"/api/auth/me\"),{withCredentials:true});const userData=response.data;// Check if user is approved\nif(userData.approved===false){navigate(\"/pending\",{replace:true});return;}setUser(userData);setIsAuthenticated(true);}catch(error){setIsAuthenticated(false);}};checkAuth();},[location.state,navigate]);if(isAuthenticated===null){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-[#F8FAFC]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-[#2E5C38] border-r-transparent\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-[#475569]\",children:\"Loading...\"})]})});}if(!isAuthenticated){return/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true});}return children;}","map":{"version":3,"names":["useState","useEffect","Navigate","useLocation","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","BACKEND_URL","process","env","REACT_APP_BACKEND_URL","ProtectedRoute","_ref","_useLocation$state","_useLocation$state2","children","isAuthenticated","setIsAuthenticated","state","user","setUser","location","navigate","_location$state","checkAuth","response","get","concat","withCredentials","userData","data","approved","replace","error","className","to"],"sources":["/Users/mrinmayee/TGPTaskflow/frontend/src/components/ProtectedRoute.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { Navigate, useLocation, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\n\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL;\n\nexport default function ProtectedRoute({ children }) {\n  const [isAuthenticated, setIsAuthenticated] = useState(\n    useLocation().state?.user ? true : null\n  );\n  const [user, setUser] = useState(useLocation().state?.user || null);\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (location.state?.user) return;\n\n    const checkAuth = async () => {\n      try {\n        const response = await axios.get(`${BACKEND_URL}/api/auth/me`, {\n          withCredentials: true\n        });\n        const userData = response.data;\n        \n        // Check if user is approved\n        if (userData.approved === false) {\n          navigate(\"/pending\", { replace: true });\n          return;\n        }\n        \n        setUser(userData);\n        setIsAuthenticated(true);\n      } catch (error) {\n        setIsAuthenticated(false);\n      }\n    };\n\n    checkAuth();\n  }, [location.state, navigate]);\n\n  if (isAuthenticated === null) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-[#F8FAFC]\">\n        <div className=\"text-center\">\n          <div className=\"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-[#2E5C38] border-r-transparent\"></div>\n          <p className=\"mt-4 text-[#475569]\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return <Navigate to=\"/\" replace />;\n  }\n\n  return children;\n}"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,QAAQ,CAAEC,WAAW,CAAEC,WAAW,KAAQ,kBAAkB,CACrE,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE1B,KAAM,CAAAC,WAAW,CAAGC,OAAO,CAACC,GAAG,CAACC,qBAAqB,CAErD,cAAe,SAAS,CAAAC,cAAcA,CAAAC,IAAA,CAAe,KAAAC,kBAAA,CAAAC,mBAAA,IAAd,CAAEC,QAAS,CAAC,CAAAH,IAAA,CACjD,KAAM,CAACI,eAAe,CAAEC,kBAAkB,CAAC,CAAGpB,QAAQ,CACpD,CAAAgB,kBAAA,CAAAb,WAAW,CAAC,CAAC,CAACkB,KAAK,UAAAL,kBAAA,WAAnBA,kBAAA,CAAqBM,IAAI,CAAG,IAAI,CAAG,IACrC,CAAC,CACD,KAAM,CAACA,IAAI,CAAEC,OAAO,CAAC,CAAGvB,QAAQ,CAAC,EAAAiB,mBAAA,CAAAd,WAAW,CAAC,CAAC,CAACkB,KAAK,UAAAJ,mBAAA,iBAAnBA,mBAAA,CAAqBK,IAAI,GAAI,IAAI,CAAC,CACnE,KAAM,CAAAE,QAAQ,CAAGrB,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAsB,QAAQ,CAAGrB,WAAW,CAAC,CAAC,CAE9BH,SAAS,CAAC,IAAM,KAAAyB,eAAA,CACd,IAAAA,eAAA,CAAIF,QAAQ,CAACH,KAAK,UAAAK,eAAA,WAAdA,eAAA,CAAgBJ,IAAI,CAAE,OAE1B,KAAM,CAAAK,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAvB,KAAK,CAACwB,GAAG,IAAAC,MAAA,CAAIpB,WAAW,iBAAgB,CAC7DqB,eAAe,CAAE,IACnB,CAAC,CAAC,CACF,KAAM,CAAAC,QAAQ,CAAGJ,QAAQ,CAACK,IAAI,CAE9B;AACA,GAAID,QAAQ,CAACE,QAAQ,GAAK,KAAK,CAAE,CAC/BT,QAAQ,CAAC,UAAU,CAAE,CAAEU,OAAO,CAAE,IAAK,CAAC,CAAC,CACvC,OACF,CAEAZ,OAAO,CAACS,QAAQ,CAAC,CACjBZ,kBAAkB,CAAC,IAAI,CAAC,CAC1B,CAAE,MAAOgB,KAAK,CAAE,CACdhB,kBAAkB,CAAC,KAAK,CAAC,CAC3B,CACF,CAAC,CAEDO,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,CAACH,QAAQ,CAACH,KAAK,CAAEI,QAAQ,CAAC,CAAC,CAE9B,GAAIN,eAAe,GAAK,IAAI,CAAE,CAC5B,mBACEZ,IAAA,QAAK8B,SAAS,CAAC,4DAA4D,CAAAnB,QAAA,cACzET,KAAA,QAAK4B,SAAS,CAAC,aAAa,CAAAnB,QAAA,eAC1BX,IAAA,QAAK8B,SAAS,CAAC,8GAA8G,CAAM,CAAC,cACpI9B,IAAA,MAAG8B,SAAS,CAAC,qBAAqB,CAAAnB,QAAA,CAAC,YAAU,CAAG,CAAC,EAC9C,CAAC,CACH,CAAC,CAEV,CAEA,GAAI,CAACC,eAAe,CAAE,CACpB,mBAAOZ,IAAA,CAACL,QAAQ,EAACoC,EAAE,CAAC,GAAG,CAACH,OAAO,MAAE,CAAC,CACpC,CAEA,MAAO,CAAAjB,QAAQ,CACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}