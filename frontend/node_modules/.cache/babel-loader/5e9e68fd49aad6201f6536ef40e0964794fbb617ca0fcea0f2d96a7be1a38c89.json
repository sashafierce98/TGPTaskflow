{"ast":null,"code":"import{useEffect,useRef}from\"react\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import{toast}from\"sonner\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=process.env.REACT_APP_BACKEND_URL;export default function AuthCallback(){const navigate=useNavigate();const hasProcessed=useRef(false);useEffect(()=>{if(hasProcessed.current)return;hasProcessed.current=true;const processAuth=async()=>{const hash=window.location.hash.substring(1);const params=new URLSearchParams(hash);const sessionId=params.get('session_id');if(!sessionId){toast.error(\"Authentication failed\");navigate(\"/\");return;}try{const response=await axios.post(\"\".concat(BACKEND_URL,\"/api/auth/session\"),{},{headers:{\"X-Session-ID\":sessionId},withCredentials:true});const user=response.data;// Check if user needs approval\nif(user.approved===false){navigate(\"/pending\",{replace:true});return;}toast.success(\"Welcome, \".concat(user.name,\"!\"));navigate(\"/dashboard\",{state:{user},replace:true});}catch(error){console.error(\"Auth error:\",error);toast.error(\"Authentication failed\");navigate(\"/\");}};processAuth();},[navigate]);return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-[#F8FAFC]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-[#2E5C38] border-r-transparent\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-[#475569]\",children:\"Authenticating...\"})]})});}","map":{"version":3,"names":["useEffect","useRef","useNavigate","axios","toast","jsx","_jsx","jsxs","_jsxs","BACKEND_URL","process","env","REACT_APP_BACKEND_URL","AuthCallback","navigate","hasProcessed","current","processAuth","hash","window","location","substring","params","URLSearchParams","sessionId","get","error","response","post","concat","headers","withCredentials","user","data","approved","replace","success","name","state","console","className","children"],"sources":["/Users/mrinmayee/TGPTaskflow/frontend/src/pages/AuthCallback.js"],"sourcesContent":["import { useEffect, useRef } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { toast } from \"sonner\";\n\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL;\n\nexport default function AuthCallback() {\n  const navigate = useNavigate();\n  const hasProcessed = useRef(false);\n\n  useEffect(() => {\n    if (hasProcessed.current) return;\n    hasProcessed.current = true;\n\n    const processAuth = async () => {\n      const hash = window.location.hash.substring(1);\n      const params = new URLSearchParams(hash);\n      const sessionId = params.get('session_id');\n\n      if (!sessionId) {\n        toast.error(\"Authentication failed\");\n        navigate(\"/\");\n        return;\n      }\n\n      try {\n        const response = await axios.post(\n          `${BACKEND_URL}/api/auth/session`,\n          {},\n          {\n            headers: { \"X-Session-ID\": sessionId },\n            withCredentials: true\n          }\n        );\n\n        const user = response.data;\n        \n        // Check if user needs approval\n        if (user.approved === false) {\n          navigate(\"/pending\", { replace: true });\n          return;\n        }\n        \n        toast.success(`Welcome, ${user.name}!`);\n        navigate(\"/dashboard\", { state: { user }, replace: true });\n      } catch (error) {\n        console.error(\"Auth error:\", error);\n        toast.error(\"Authentication failed\");\n        navigate(\"/\");\n      }\n    };\n\n    processAuth();\n  }, [navigate]);\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-[#F8FAFC]\">\n      <div className=\"text-center\">\n        <div className=\"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-[#2E5C38] border-r-transparent\"></div>\n        <p className=\"mt-4 text-[#475569]\">Authenticating...</p>\n      </div>\n    </div>\n  );\n}"],"mappings":"AAAA,OAASA,SAAS,CAAEC,MAAM,KAAQ,OAAO,CACzC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,KAAK,KAAQ,QAAQ,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/B,KAAM,CAAAC,WAAW,CAAGC,OAAO,CAACC,GAAG,CAACC,qBAAqB,CAErD,cAAe,SAAS,CAAAC,YAAYA,CAAA,CAAG,CACrC,KAAM,CAAAC,QAAQ,CAAGZ,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAa,YAAY,CAAGd,MAAM,CAAC,KAAK,CAAC,CAElCD,SAAS,CAAC,IAAM,CACd,GAAIe,YAAY,CAACC,OAAO,CAAE,OAC1BD,YAAY,CAACC,OAAO,CAAG,IAAI,CAE3B,KAAM,CAAAC,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,KAAM,CAAAC,IAAI,CAAGC,MAAM,CAACC,QAAQ,CAACF,IAAI,CAACG,SAAS,CAAC,CAAC,CAAC,CAC9C,KAAM,CAAAC,MAAM,CAAG,GAAI,CAAAC,eAAe,CAACL,IAAI,CAAC,CACxC,KAAM,CAAAM,SAAS,CAAGF,MAAM,CAACG,GAAG,CAAC,YAAY,CAAC,CAE1C,GAAI,CAACD,SAAS,CAAE,CACdpB,KAAK,CAACsB,KAAK,CAAC,uBAAuB,CAAC,CACpCZ,QAAQ,CAAC,GAAG,CAAC,CACb,OACF,CAEA,GAAI,CACF,KAAM,CAAAa,QAAQ,CAAG,KAAM,CAAAxB,KAAK,CAACyB,IAAI,IAAAC,MAAA,CAC5BpB,WAAW,sBACd,CAAC,CAAC,CACF,CACEqB,OAAO,CAAE,CAAE,cAAc,CAAEN,SAAU,CAAC,CACtCO,eAAe,CAAE,IACnB,CACF,CAAC,CAED,KAAM,CAAAC,IAAI,CAAGL,QAAQ,CAACM,IAAI,CAE1B;AACA,GAAID,IAAI,CAACE,QAAQ,GAAK,KAAK,CAAE,CAC3BpB,QAAQ,CAAC,UAAU,CAAE,CAAEqB,OAAO,CAAE,IAAK,CAAC,CAAC,CACvC,OACF,CAEA/B,KAAK,CAACgC,OAAO,aAAAP,MAAA,CAAaG,IAAI,CAACK,IAAI,KAAG,CAAC,CACvCvB,QAAQ,CAAC,YAAY,CAAE,CAAEwB,KAAK,CAAE,CAAEN,IAAK,CAAC,CAAEG,OAAO,CAAE,IAAK,CAAC,CAAC,CAC5D,CAAE,MAAOT,KAAK,CAAE,CACda,OAAO,CAACb,KAAK,CAAC,aAAa,CAAEA,KAAK,CAAC,CACnCtB,KAAK,CAACsB,KAAK,CAAC,uBAAuB,CAAC,CACpCZ,QAAQ,CAAC,GAAG,CAAC,CACf,CACF,CAAC,CAEDG,WAAW,CAAC,CAAC,CACf,CAAC,CAAE,CAACH,QAAQ,CAAC,CAAC,CAEd,mBACER,IAAA,QAAKkC,SAAS,CAAC,4DAA4D,CAAAC,QAAA,cACzEjC,KAAA,QAAKgC,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BnC,IAAA,QAAKkC,SAAS,CAAC,8GAA8G,CAAM,CAAC,cACpIlC,IAAA,MAAGkC,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAC,mBAAiB,CAAG,CAAC,EACrD,CAAC,CACH,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}